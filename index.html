<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Pension Calculator</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <style>
      :root {
        --bg: #f6f8fb;
        --card: #ffffff;
        --muted: #6b7280;
        --text: #0f1724;
        --primary: #1f6feb;
        --border: #e6e9ee;
        --radius: 8px;
      }

      html,
      body {
        height: 100%;
        margin: 0;
        font-family: Inter, "Segoe UI", Roboto, Arial, system-ui, -apple-system;
        color: var(--text);
        background: var(--bg);
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      .wrap {
        max-width: 980px;
        margin: 28px auto;
        padding: 12px;
      }

      header {
        display: flex;
        gap: 12px;
        align-items: center;
        margin-bottom: 12px;
      }

      .logo {
        width: 44px;
        height: 44px;
        border-radius: 10px;
        background: var(--primary);
        color: #fff;
        display: grid;
        place-items: center;
        font-weight: 700;
        font-size: 18px;
      }

      h1 {
        margin: 0;
        font-size: 18px;
      }
      p.lead {
        margin: 6px 0 0 0;
        color: var(--muted);
        font-size: 13px;
      }

      .layout {
        display: grid;
        grid-template-columns: 1fr 340px;
        gap: 10px;
      }
      @media (max-width: 880px) {
        .layout {
          grid-template-columns: 1fr;
        }
      }
      .card {
        background: var(--card);
        border: 1px solid var(--border);
        border-radius: var(--radius);
        padding: 10px;
        box-shadow: 0 2px 5px rgba(16, 24, 40, 0.03);
      }
      /* VERTICAL FORM OVERRIDES */
      .form-row,
      .form-row.compact {
        flex-direction: column !important;
        align-items: flex-start !important;
        gap: 2px;
        margin-bottom: 14px;
        display: flex;
      }
      .form-row .label {
        min-width: unset;
        font-size: 13px;
        margin-bottom: 3px;
        padding-right: 0;
      }
      .form-row .control {
        width: 100%;
        flex: unset;
      }
      .form-row input,
      .form-row select {
        margin-bottom: 8px;
      }
      input[type="number"],
      input[type="text"],
      select {
        width: 100%;
        padding: 7px 8px;
        font-size: 14px;
        border-radius: 6px;
        border: 1px solid var(--border);
        background: #fff;
        color: var(--text);
        box-sizing: border-box;
      }
      input::placeholder {
        color: #b8bec9;
      }
      h4.small {
        margin-top: 10px;
        margin-bottom: 4px;
        font-size: 12px;
        color: #b25c19;
      }
      .bold-note {
        margin: 8px 0 12px 0;
        font-weight: bold;
        color: #b25c19;
        background: #fff7ea;
        border-left: 4px solid #f08a24;
        padding: 10px 14px;
        font-size: 15px;
        border-radius: 6px;
        line-height: 1.6;
      }
      .small {
        font-size: 12px;
        color: var(--muted);
      }
      .row {
        display: flex;
        gap: 6px;
        margin-top: 8px;
        flex-wrap: wrap;
      }
      button {
        padding: 8px 10px;
        border-radius: 6px;
        border: none;
        font-weight: 600;
        cursor: pointer;
        background: var(--primary);
        color: white;
        font-size: 14px;
      }
      button.secondary {
        background: transparent;
        color: var(--text);
        border: 1px solid var(--border);
      }
      button[disabled] {
        opacity: 0.5;
        cursor: not-allowed;
      }
      .muted {
        color: var(--muted);
        font-size: 12px;
      }
      .checkbox-inline {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-top: 4px;
      }
      .summary {
        display: flex;
        gap: 6px;
        margin-top: 8px;
        flex-wrap: wrap;
      }
      .stat {
        background: #fbfdff;
        border: 1px solid var(--border);
        border-radius: 6px;
        padding: 7px;
        min-width: 90px;
      }
      .stat .label {
        color: var(--muted);
        font-size: 12px;
      }
      .stat .value {
        font-weight: 700;
        font-size: 15px;
        margin-top: 2px;
        color: var(--text);
      }
      .combined-list {
        display: flex;
        flex-direction: column;
        gap: 7px;
        margin-top: 7px;
      }
      .combined-item {
        border: 1px solid var(--border);
        border-radius: 6px;
        padding: 7px;
        background: #fff;
      }
      .combined-item .rate {
        font-weight: 700;
        color: var(--text);
        margin-bottom: 5px;
        font-size: 14px;
      }
      .combined-item .row-grid {
        display: grid;
        grid-template-columns: 1fr auto;
        gap: 3px 8px;
        align-items: center;
        font-size: 12px;
      }
      .combined-item .label {
        color: var(--muted);
      }
      .combined-item .total-value {
        margin-top: 3px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .combined-item .total-value .label {
        color: var(--muted);
        font-weight: 600;
      }
      .combined-item .total-value .value {
        font-size: 15px;
        color: var(--text);
      }
      aside > .card {
        margin-bottom: 8px;
      }
      .person-results {
        margin-top: 7px;
        display: flex;
        flex-direction: column;
        gap: 6px;
      }
      .person-result-item {
        border: 1px solid var(--border);
        border-radius: 6px;
        padding: 7px;
        background: #fff;
      }
      .person-result-item .rate {
        font-weight: 700;
        color: var(--text);
        margin-bottom: 3px;
      }
      .person-result-item .grid {
        display: grid;
        grid-template-columns: 1fr auto;
        gap: 3px 8px;
        align-items: center;
        font-size: 12px;
      }
      .person-result-item .total {
        margin-top: 4px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .person-result-item .total .value {
        font-weight: 700;
        font-size: 14px;
        color: var(--text);
      }
      .person-result-item .extra-expense-row {
        display: flex;
        justify-content: space-between;
        margin-top: 3px;
        font-size: 12px;
        color: var(--muted);
      }
      .person-result-item .leftover-positive {
        color: #228b22;
        font-weight: bold;
      }
      .person-result-item .leftover-negative {
        color: #c92a2a;
        font-weight: bold;
      }
      .retirement-expense-highlights {
        margin-top: 16px;
        margin-bottom: 2px;
        padding: 15px 18px 11px 18px;
        background: #fdf6ec;
        border: 1.5px solid #f5c186;
        border-radius: 10px;
        font-size: 17px;
        font-family: "Segoe UI", Inter, Roboto, Arial, sans-serif;
        font-weight: 500;
        display: flex;
        flex-direction: column;
        gap: 10px;
        box-shadow: 0 2px 8px rgba(233, 146, 67, 0.06);
      }
      .retirement-expense-highlights .expense-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .retirement-expense-highlights .expense-label {
        color: #aa6200;
        font-size: 15px;
        font-weight: 600;
        letter-spacing: 0.01em;
      }
      .retirement-expense-highlights .expense-value {
        color: #f08a24;
        font-size: 21px;
        font-weight: 800;
        letter-spacing: 0.005em;
        text-shadow: 0 0.5px 0 #ffe0b2;
      }
      .retirement-expense-highlights .leftover-label {
        color: #332900;
        font-size: 15px;
        font-weight: 600;
      }
      .retirement-expense-highlights .leftover-value {
        font-size: 22px;
        font-weight: 800;
        letter-spacing: 0.005em;
        text-shadow: 0 0.5px 0 #fff;
      }
      .retirement-expense-highlights .leftover-positive {
        color: #228b22;
      }
      .retirement-expense-highlights .leftover-negative {
        color: #d62828;
      }
    </style>
  </head>
  <body>
    <div class="wrap">
      <header>
        <div class="logo">PC</div>
        <div>
          <h1>Pension Calculator</h1>
          <p class="lead">
            Simple projections for Retirement, ISA and SIPP. Choose to add a
            partner and combine totals.
          </p>
        </div>
      </header>

      <div id="root"></div>
    </div>

    <!-- React + Babel -->
    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.development.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"
    ></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
      const { useState } = React;

      function toNum(v) {
        const n = parseFloat(String(v).replace(/,/g, ""));
        return Number.isFinite(n) ? n : 0;
      }

      function fvLump(initial, rate, years) {
        return initial * Math.pow(1 + rate, years);
      }

      function fvSeries(annualContribution, rate, years) {
        if (years <= 0) return 0;
        if (rate === 0) return annualContribution * years;
        return (annualContribution * (Math.pow(1 + rate, years) - 1)) / rate;
      }

      function calculatePerson(person, rates) {
        const currentAge = toNum(person.currentAge);
        const retirementAge = toNum(person.retirementAge);
        const yearsUntilRetirement = Math.max(
          0,
          Math.floor(retirementAge - currentAge)
        );
        const expenseYears = toNum(person.retirementExpenseYears);
        const monthlyExpense = toNum(person.retirementMonthlyExpense);
        const totalRetirementExpense = monthlyExpense * 12 * expenseYears;

        const results = rates.map((r) => {
          const retirementFV =
            fvLump(toNum(person.retirement.initial), r, yearsUntilRetirement) +
            fvSeries(toNum(person.retirement.annual), r, yearsUntilRetirement);
          const isaFV =
            fvLump(toNum(person.isa.initial), r, yearsUntilRetirement) +
            fvSeries(toNum(person.isa.annual), r, yearsUntilRetirement);
          const sippFV =
            fvLump(toNum(person.sipp.initial), r, yearsUntilRetirement) +
            fvSeries(toNum(person.sipp.annual), r, yearsUntilRetirement);
          const total = retirementFV + isaFV + sippFV;
          const leftOver = total - totalRetirementExpense;
          return {
            rate: r,
            retirementFV,
            isaFV,
            sippFV,
            total,
            totalRetirementExpense,
            leftOver,
            expenseYears,
            monthlyExpense,
          };
        });
        return { years: yearsUntilRetirement, results };
      }

      function Money({ value }) {
        return (value || 0).toLocaleString(undefined, {
          minimumFractionDigits: 2,
          maximumFractionDigits: 2,
        });
      }

      const emptyPerson = {
        currentAge: "",
        retirementAge: "",
        retirementMonthlyExpense: "",
        retirementExpenseYears: "",
        retirement: { initial: "", annual: "" },
        isa: { initial: "", annual: "" },
        sipp: { initial: "", annual: "" },
      };

      // --- BOLD STATE PENSION NOTE CONTENT: update here as needed ---
      const StatePensionNote = () => (
        <div className="bold-note">
          <ul>
            <li>From age 67, you may receive the UK State Pension.</li>

            <li>The full pension is £230.25/week (April 2025–March 2026).</li>

            <li>
              {" "}
              You need at least 10 qualifying years to get anything, and 35
              years for the full amount. Less than 35 years gives a
              proportionally reduced pension.
            </li>

            <li>The State Pension age is currently 66 (as of 2025).</li>
          </ul>
        </div>
      );

      function PersonForm({ title, person, onChange, onCalculate, results }) {
        const setField = (path, value) => {
          const next = JSON.parse(JSON.stringify(person));
          const keys = path.split(".");
          let cur = next;
          while (keys.length > 1) {
            cur = cur[keys.shift()];
          }
          cur[keys[0]] = value;
          onChange(next);
        };

        const showYears =
          person.currentAge &&
          person.retirementAge &&
          toNum(person.retirementAge) > toNum(person.currentAge);

        // best projection is results?.results[2]
        const best =
          results && results.results && results.results.length === 3
            ? results.results[2]
            : null;

        const showExpenseHighlight =
          best &&
          best.totalRetirementExpense > 0 &&
          best.expenseYears > 0 &&
          best.monthlyExpense > 0;

        return (
          <>
            <div className="card" aria-label={title}>
              <h3 style={{ margin: 0 }}>{title}</h3>

              <div className="form-row">
                <table>
                  <tr>
                    <td>
                      {" "}
                      <div className="label">Current age</div>
                    </td>
                    <td>
                      {" "}
                      <div className="control" style={{ maxWidth: 80 }}>
                        <input
                          type="number"
                          min="0"
                          placeholder="45"
                          value={person.currentAge}
                          onChange={(e) =>
                            setField("currentAge", e.target.value)
                          }
                        />
                      </div>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <div className="label">Retirement age</div>
                    </td>

                    <td>
                      {" "}
                      <div className="control" style={{ maxWidth: 80 }}>
                        <input
                          type="number"
                          min={toNum(person.currentAge) + 1}
                          placeholder="65"
                          value={person.retirementAge}
                          onChange={(e) =>
                            setField("retirementAge", e.target.value)
                          }
                        />
                      </div>
                    </td>
                  </tr>
                </table>
                <div>
                  {showYears && (
                    <span className="small" style={{ paddingLeft: 12 }}>
                      <h4 className="small">
                        Years:
                        <b>
                          {toNum(person.retirementAge) -
                            toNum(person.currentAge)}
                        </b>{" "}
                      </h4>
                    </span>
                  )}
                </div>
              </div>

              {!showYears && person.currentAge && person.retirementAge && (
                <div
                  className="small muted"
                  style={{ marginBottom: 3, color: "red" }}
                >
                  Retirement age should be greater than current age.
                </div>
              )}

              <h4 className="small">Retirement</h4>
              <div className="form-row compact card">
                <div className="label">Current balance</div>
                <div className="control">
                  <input
                    type="text"
                    inputMode="decimal"
                    placeholder="0.00"
                    value={person.retirement.initial}
                    onChange={(e) =>
                      setField("retirement.initial", e.target.value)
                    }
                  />
                </div>
                <div className="label">Annual contribution</div>
                <div className="control">
                  <input
                    type="text"
                    inputMode="decimal"
                    placeholder="0.00"
                    value={person.retirement.annual}
                    onChange={(e) =>
                      setField("retirement.annual", e.target.value)
                    }
                  />
                </div>
              </div>

              <h4 className="small">ISA</h4>
              <div className="form-row compact card">
                <div className="label">Current balance</div>
                <div className="control">
                  <input
                    type="text"
                    inputMode="decimal"
                    placeholder="0.00"
                    value={person.isa.initial}
                    onChange={(e) => setField("isa.initial", e.target.value)}
                  />
                </div>
                <div className="label">Annual contribution</div>
                <div className="control">
                  <input
                    type="text"
                    inputMode="decimal"
                    placeholder="0.00"
                    value={person.isa.annual}
                    onChange={(e) => setField("isa.annual", e.target.value)}
                  />
                </div>
              </div>

              <h4 className="small">SIPP</h4>
              <div className="form-row compact card">
                <div className="label">Current balance</div>
                <div className="control">
                  <input
                    type="text"
                    inputMode="decimal"
                    placeholder="0.00"
                    value={person.sipp.initial}
                    onChange={(e) => setField("sipp.initial", e.target.value)}
                  />
                </div>
                <div className="label">Annual contribution</div>
                <div className="control">
                  <input
                    type="text"
                    inputMode="decimal"
                    placeholder="0.00"
                    value={person.sipp.annual}
                    onChange={(e) => setField("sipp.annual", e.target.value)}
                  />
                </div>

                <h4 className="small">Retirement Expense</h4>
                <div className="form-row compact card">
                  <div className="label">Monthly expected expense</div>
                  <div className="control">
                    <input
                      type="text"
                      inputMode="decimal"
                      placeholder="1200"
                      value={person.retirementMonthlyExpense}
                      onChange={(e) =>
                        setField("retirementMonthlyExpense", e.target.value)
                      }
                    />
                  </div>
                  <div className="label">No. of years</div>
                  <div className="control">
                    <input
                      type="number"
                      min="1"
                      placeholder="25"
                      value={person.retirementExpenseYears}
                      onChange={(e) =>
                        setField("retirementExpenseYears", e.target.value)
                      }
                    />
                  </div>

                  {/* State Pension Note - Inserted directly below Retirement Expense */}
                  <StatePensionNote />
                </div>
              </div>

              <div className="row" style={{ marginTop: 8 }}>
                <button
                  onClick={() => {
                    if (
                      toNum(person.retirementAge) > toNum(person.currentAge)
                    ) {
                      onCalculate();
                    }
                  }}
                >
                  Calculate
                </button>
                <button
                  className="secondary"
                  onClick={() =>
                    onChange(JSON.parse(JSON.stringify(emptyPerson)))
                  }
                  type="button"
                >
                  Reset person
                </button>
              </div>

              {results && (
                <div className="person-results" aria-live="polite">
                  <div style={{ fontSize: 12, color: "var(--muted)" }}>
                    Projections for <strong>{results.years}</strong> years
                  </div>
                  {results.results.map((r) => (
                    <div className="person-result-item" key={r.rate}>
                      <div className="rate">
                        {(r.rate * 100).toFixed(0)}% projection
                      </div>
                      <div className="grid">
                        <div className="label">Retirement</div>
                        <div className="value">
                          £{(r.retirementFV || 0).toLocaleString()}
                        </div>
                        <div className="label">ISA</div>
                        <div className="value">
                          £{(r.isaFV || 0).toLocaleString()}
                        </div>
                        <div className="label">SIPP</div>
                        <div className="value">
                          £{(r.sippFV || 0).toLocaleString()}
                        </div>
                      </div>
                      <div className="total">
                        <div className="label">Total</div>
                        <div className="value">
                          £{(r.total || 0).toLocaleString()}
                        </div>
                      </div>
                      {r.monthlyExpense > 0 && r.expenseYears > 0 && (
                        <>
                          <div className="extra-expense-row">
                            <span>
                              Retirement expense needed
                              <br />
                              (£{Money({ value: r.monthlyExpense })} × 12 ×{" "}
                              {r.expenseYears} years)
                            </span>
                            <span>
                              £{Money({ value: r.totalRetirementExpense })}
                            </span>
                          </div>
                          <div className="extra-expense-row">
                            <span>
                              {r.leftOver >= 0 ? "Left over" : "Shortfall"}
                            </span>
                            <span
                              className={
                                r.leftOver >= 0
                                  ? "leftover-positive"
                                  : "leftover-negative"
                              }
                            >
                              £{Money({ value: r.leftOver })}
                            </span>
                          </div>
                        </>
                      )}
                    </div>
                  ))}
                </div>
              )}
            </div>
            {showExpenseHighlight && (
              <div className="retirement-expense-highlights">
                <div className="expense-row">
                  <span className="expense-label">
                    Retirement expense needed
                  </span>
                  <span className="expense-value">
                    £{(best.totalRetirementExpense || 0).toLocaleString()}
                  </span>
                </div>
                <div className="expense-row">
                  <span className="leftover-label">
                    {best.leftOver >= 0 ? "Left over" : "Shortfall"}
                  </span>
                  <span
                    className={`leftover-value ${
                      best.leftOver >= 0
                        ? "leftover-positive"
                        : "leftover-negative"
                    }`}
                  >
                    £
                    {Math.abs(best.leftOver || 0).toLocaleString(undefined, {
                      minimumFractionDigits: 2,
                      maximumFractionDigits: 2,
                    })}
                  </span>
                </div>
              </div>
            )}
          </>
        );
      }

      function App() {
        const rates = [0.04, 0.06, 0.08];

        const [person1, setPerson1] = useState(
          JSON.parse(JSON.stringify(emptyPerson))
        );
        const [person2, setPerson2] = useState(
          JSON.parse(JSON.stringify(emptyPerson))
        );
        const [hasPartner, setHasPartner] = useState(false);

        const [res1, setRes1] = useState(null);
        const [res2, setRes2] = useState(null);
        const [combined, setCombined] = useState(null);

        function calc1() {
          const r = calculatePerson(person1, rates);
          setRes1(r);
          setCombined(null);
        }

        function calc2() {
          const r = calculatePerson(person2, rates);
          setRes2(r);
          setCombined(null);
        }

        function totalBoth() {
          const a = res1 || calculatePerson(person1, rates);
          const b = res2 || calculatePerson(person2, rates);
          const summed = a.results.map((ar, idx) => {
            const br = b.results[idx];
            return {
              rate: ar.rate,
              retirementFV: ar.retirementFV + br.retirementFV,
              isaFV: ar.isaFV + br.isaFV,
              sippFV: ar.sippFV + br.sippFV,
              total: ar.total + br.total,
              totalRetirementExpense:
                ar.totalRetirementExpense + br.totalRetirementExpense,
              leftOver: ar.leftOver + br.leftOver,
            };
          });
          setCombined({ years: `${a.years} / ${b.years}`, results: summed });
        }

        // For combined highlight: show only if both p1 and p2 have valid entries and both results exist
        const showCombinedHighlight =
          combined &&
          combined.results &&
          combined.results.length === 3 &&
          (combined.results[2].totalRetirementExpense > 0 ||
            combined.results[2].leftOver !== undefined);

        return (
          <div className="layout">
            <div>
              <PersonForm
                title="Person 1"
                person={person1}
                onChange={setPerson1}
                onCalculate={calc1}
                results={res1}
              />

              <div style={{ marginTop: 12 }} className="card">
                <h3 style={{ margin: 0 }}>Partner</h3>
                <div className="checkbox-inline">
                  <input
                    id="partner"
                    type="checkbox"
                    checked={hasPartner}
                    onChange={(e) => setHasPartner(e.target.checked)}
                  />
                  <label
                    htmlFor="partner"
                    className="muted"
                    style={{ margin: 0 }}
                  >
                    Add partner
                  </label>
                </div>

                {!hasPartner ? (
                  <p className="muted" style={{ marginTop: 8 }}>
                    Partner not added. Toggle the checkbox to add a partner.
                  </p>
                ) : (
                  <div style={{ marginTop: 8 }}>
                    <PersonForm
                      title="Person 2"
                      person={person2}
                      onChange={setPerson2}
                      onCalculate={calc2}
                      results={res2}
                    />
                  </div>
                )}
              </div>
            </div>

            <aside>
              <div className="card">
                <h3 style={{ margin: 0 }}>Totals</h3>

                <div className="row" style={{ marginTop: 8 }}>
                  <button onClick={totalBoth} disabled={!hasPartner}>
                    Total Both People
                  </button>
                  <button
                    className="secondary"
                    onClick={() => {
                      setPerson1(JSON.parse(JSON.stringify(emptyPerson)));
                      setPerson2(JSON.parse(JSON.stringify(emptyPerson)));
                      setRes1(null);
                      setRes2(null);
                      setCombined(null);
                      setHasPartner(false);
                    }}
                  >
                    Reset All
                  </button>
                </div>

                {!hasPartner && (
                  <p className="muted" style={{ marginTop: 8 }}>
                    Add partner to enable the combined total.
                  </p>
                )}

                {combined && (
                  <>
                    <div className="combined-list" aria-live="polite">
                      <div style={{ fontSize: 12, color: "var(--muted)" }}>
                        Combined totals{" "}
                        <span
                          style={{ color: "var(--muted)", fontWeight: 600 }}
                        >
                          ({combined.years})
                        </span>
                      </div>

                      {combined.results.map((r) => (
                        <div className="combined-item" key={r.rate}>
                          <div className="rate">
                            {(r.rate * 100).toFixed(0)}% projection
                          </div>
                          <div className="row-grid" style={{ marginBottom: 2 }}>
                            <div className="label">Retirement</div>
                            <div className="value">
                              £{(r.retirementFV || 0).toLocaleString()}
                            </div>
                            <div className="label">ISA</div>
                            <div className="value">
                              £{(r.isaFV || 0).toLocaleString()}
                            </div>
                            <div className="label">SIPP</div>
                            <div className="value">
                              £{(r.sippFV || 0).toLocaleString()}
                            </div>
                          </div>
                          <div className="total-value">
                            <div className="label">Total</div>
                            <div className="value total-value-number">
                              £{(r.total || 0).toLocaleString()}
                            </div>
                          </div>
                          {r.totalRetirementExpense > 0 && (
                            <div className="extra-expense-row">
                              <span>Combined retirement expense needed</span>
                              <span>
                                £
                                {(
                                  r.totalRetirementExpense || 0
                                ).toLocaleString()}
                              </span>
                            </div>
                          )}
                          {r.totalRetirementExpense > 0 && (
                            <div className="extra-expense-row">
                              <span>
                                {r.leftOver >= 0 ? "Left over" : "Shortfall"}
                              </span>
                              <span
                                className={
                                  r.leftOver >= 0
                                    ? "leftover-positive"
                                    : "leftover-negative"
                                }
                              >
                                £
                                {(r.leftOver || 0).toLocaleString(undefined, {
                                  minimumFractionDigits: 2,
                                  maximumFractionDigits: 2,
                                })}
                              </span>
                            </div>
                          )}
                        </div>
                      ))}
                    </div>
                    {showCombinedHighlight && (
                      <div className="retirement-expense-highlights">
                        <div className="expense-row">
                          <span className="expense-label">
                            Combined retirement expense needed
                          </span>
                          <span className="expense-value">
                            £
                            {(
                              combined.results[2].totalRetirementExpense || 0
                            ).toLocaleString()}
                          </span>
                        </div>
                        <div className="expense-row">
                          <span className="leftover-label">
                            {combined.results[2].leftOver >= 0
                              ? "Left over"
                              : "Shortfall"}
                          </span>
                          <span
                            className={`leftover-value ${
                              combined.results[2].leftOver >= 0
                                ? "leftover-positive"
                                : "leftover-negative"
                            }`}
                          >
                            £
                            {Math.abs(
                              combined.results[2].leftOver || 0
                            ).toLocaleString(undefined, {
                              minimumFractionDigits: 2,
                              maximumFractionDigits: 2,
                            })}
                          </span>
                        </div>
                      </div>
                    )}
                  </>
                )}
              </div>
            </aside>
          </div>
        );
      }

      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  </body>
</html>
